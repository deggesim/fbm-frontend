<form [formGroup]="form" (ngSubmit)="calcolaRisultato()" class="needs-validation" novalidate>
  <fieldset class="fieldset">
    <legend class="legend"><fa-icon icon="poll-h" class="icon-padding"></fa-icon>Risultati</legend>
    <div fxLayout="row wrap" fxLayoutAlign="space-between">
      <div fxFlex="33" fxFlex.xs="100">
        <div class="form-group">
          <label for="round" class="control-label">Round</label>
          <ng-select
            id="round"
            name="round"
            [items]="rounds"
            bindLabel="name"
            formControlName="round"
            clearAllText="Elimina"
            (change)="onChangeRound($event)"
          >
          </ng-select>
        </div>
      </div>

      <div fxFlex="33" fxFlex.xs="100">
        <div class="form-group">
          <label for="fixture" class="control-label">Giornata</label>
          <ng-select
            id="fixture"
            name="fixture"
            [items]="fixtures"
            bindLabel="name"
            formControlName="fixture"
            clearAllText="Elimina"
            (change)="onChangeFixture($event)"
          >
          </ng-select>
        </div>
      </div>

      <div fxFlex="33" fxFlex.xs="100">
        <div class="form-group">
          <label for="match" class="control-label">Incontro</label>
          <ng-select
            id="match"
            name="match"
            [items]="matches"
            formControlName="match"
            clearAllText="Elimina"
            (change)="onChangeMatch($event)"
          >
            <ng-template ng-label-tmp let-item="item" let-index="index"> {{ item.homeTeam.name }} - {{ item.awayTeam.name }} </ng-template>
            <ng-template ng-option-tmp let-item="item" let-index="index"> {{ item.homeTeam.name }} - {{ item.awayTeam.name }} </ng-template>
          </ng-select>
        </div>
      </div>

      <ng-container *ngIf="matches">
        <div fxFlex="100">
          <hr />
        </div>

        <!-- SQUADRA 1 -->
        <ng-container *ngIf="selectedMatch">
          <div fxFlex="49" fxFlex.lt-md="100">
            <div>
              <h4 id="homeTeam">{{ selectedMatch.homeTeam.name }} {{ selectedMatch.homeScore }}</h4>
            </div>
            <div>
              <label>Fattore campo: {{ selectedMatch.homeFactor }}</label>
            </div>
            <div>
              <label>Valutazione: {{ selectedMatch.homeRanking }} - Pagelle: {{ selectedMatch.homeGrade }}</label>
            </div>
            <div class="table-responsive">
              <table class="table table-hover" aria-label="Squadra in casa">
                <thead class="thead-dark">
                  <tr>
                    <th id="name">Nome</th>
                    <th id="role">Ruolo</th>
                    <th fxHide.lt-sm id="benchOrder">Ordine panchina</th>
                    <th fxHide.lt-sm id="ranking">Val.</th>
                    <th fxHide.lt-sm id="minutes">Minuti</th>
                    <th fxHide.lt-sm id="grade">Voto</th>
                    <th fxHide.lt-sm id="grade40Min">Val. dopo 40 minuti</th>
                    <th id="rankingUsed">Val. usata</th>
                    <th id="minutesUsed">Minuti usati</th>
                  </tr>
                </thead>

                <tbody>
                  <tr *ngFor="let player of homeTeamLineup; let i = index" class="table-secondary lineup-height">
                    <td class="text-nowrap">{{ player?.fantasyRoster.roster.player.name }}</td>
                    <td>{{ player?.fantasyRoster.roster.player.role | roleShort }}</td>
                    <td fxHide.lt-sm>{{ player?.benchOrder }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.ranking }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.minutes }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.grade }}</td>
                    <td fxHide.lt-sm>{{ player?.matchReport?.realRanking40Min }}</td>
                    <td>{{ player?.matchReport?.realRanking }}</td>
                    <td>{{ player?.matchReport?.minutesUsed }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>

        <!-- SQUADRA 2 -->
        <ng-container *ngIf="selectedMatch">
          <div fxFlex="49" fxFlex.lt-md="100">
            <div>
              <h4 id="awayTeam">{{ selectedMatch.awayTeam.name }} {{ selectedMatch.awayScore }}</h4>
            </div>
            <div><label>&nbsp;</label></div>
            <div>
              <label>Valutazione: {{ selectedMatch.awayRanking }} - Pagelle: {{ selectedMatch.awayGrade }}</label>
            </div>
            <div class="table-responsive">
              <table class="table table-hover" aria-label="Squadra in trasferta">
                <thead class="thead-dark">
                  <tr>
                    <th id="name">Nome</th>
                    <th id="role">Ruolo</th>
                    <th fxHide.lt-sm id="benchOrder">Ordine panchina</th>
                    <th fxHide.lt-sm id="ranking">Val.</th>
                    <th fxHide.lt-sm id="minutes">Minuti</th>
                    <th fxHide.lt-sm id="grade">Voto</th>
                    <th fxHide.lt-sm id="grade40Min">Val. dopo 40 minuti</th>
                    <th id="rankingUsed">Val. usata</th>
                    <th id="minutesUsed">Minuti usati</th>
                  </tr>
                </thead>

                <tbody>
                  <tr *ngFor="let player of awayTeamLineup; let i = index" class="table-secondary lineup-height">
                    <td class="text-nowrap">{{ player?.fantasyRoster.roster.player.name }}</td>
                    <td>{{ player?.fantasyRoster.roster.player.role | roleShort }}</td>
                    <td fxHide.lt-sm>{{ player?.benchOrder }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.ranking }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.minutes }}</td>
                    <td fxHide.lt-sm>{{ player?.performance.grade }}</td>
                    <td fxHide.lt-sm>{{ player?.matchReport?.realRanking40Min }}</td>
                    <td>{{ player?.matchReport?.realRanking }}</td>
                    <td>{{ player?.matchReport?.minutesUsed }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </fieldset>

  <div class="text-center padding">
    <button type="submit" class="btn btn-primary" [disabled]="form.invalid">
      <fa-icon icon="calculator" class="icon-padding"></fa-icon>Calcola risultato
    </button>
  </div>
</form>
