<div class="float manina" (click)="nuova()">
  <fa-icon icon="plus" class="my-float"></fa-icon>
</div>
<div
  class="float-2 indent manina"
  (click)="apriPopupUpload()"
  *ngIf="isPreseason()"
>
  <fa-icon icon="upload" class="my-float"></fa-icon>
</div>

<fieldset class="fieldset" *ngIf="percentage === 0; else uploadInProgress">
  <legend class="legend">
    <fa-icon icon="id-badge" class="icon-padding"></fa-icon>Giocatori
  </legend>
  <ng-container *ngIf="rosterList?.content && rosterList?.totalElements > 0; else empty">
    <form #form="ngForm" class="form-inline pb-1">
      <div class="input-group">
        <input
          type="text"
          class="form-control"
          id="filtro"
          name="filtro"
          #filtro="ngModel"
          [(ngModel)]="filter"
          (keyup)="applicaFiltro(filtro.value)"
          (paste)="applicaFiltro($event.clipboardData.getData('Text'))"
          placeholder="Filtro"
        />
        <div class="input-group-append manina" (click)="pulisciFiltro()">
          <div class="input-group-text">x</div>
        </div>
      </div>
    </form>
    <div class="table-responsive">
      <table class="table table-hover">
        <thead class="thead-dark">
          <tr>
            <th>Nome</th>
            <th>Nazionalit√†</th>
            <th>#</th>
            <th>Anno di nascita</th>
            <th>Altezza</th>
            <th>Peso</th>
            <th>Ruolo</th>
            <th>Squadra</th>
            <th>Azioni</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let roster of rosterList.content" class="table-secondary">
            <td>{{ roster.player.name }}</td>
            <td>{{ roster.player.nationality }}</td>
            <td>{{ roster.player.number }}</td>
            <td>{{ roster.player.yearBirth }}</td>
            <td>{{ roster.player.height }}</td>
            <td>{{ roster.player.weight }}</td>
            <td>{{ roster.player.role }}</td>
            <td>{{ roster.team.fullName }}</td>

            <td class="text-nowrap">
              <button
                type="button"
                class="btn btn-warning"
                (click)="modifica(roster)"
                tooltip="Modifica"
                placement="top"
              >
                <fa-icon icon="pencil-alt"></fa-icon>
              </button>
              <button
                type="button"
                class="btn btn-success"
                (click)="clona(roster)"
                tooltip="Clona"
                placement="top"
              >
                <fa-icon icon="clone"></fa-icon>
              </button>
              <button
                type="button"
                class="btn btn-danger"
                (click)="apriPopupElimina(roster)"
                tooltip="Elimina"
                placement="top"
              >
                <fa-icon icon="trash"></fa-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div fxLayout="row" fxLayoutAlign="center" *ngIf="abilitaPaginazione()">
      <div fxFlex="nogrow">
        <pagination
          [totalItems]="rosterList.totalElements"
          [(ngModel)]="page"
          [itemsPerPage]="limit"
          (pageChanged)="pageChange($event)"
          [maxSize]="maxSize"
          [boundaryLinks]="boundaryLinks"
          firstText="<<"
          previousText="<"
          nextText=">"
          lastText=">>"
        ></pagination>
      </div>
    </div>
  </ng-container>

  <ng-template #empty>
    <h4 class="padding">Nessun giocatore presente</h4>
  </ng-template>
</fieldset>

<!--Progress bar -->
<ng-template #uploadInProgress>
  <div class="text-center padding">
    <h4>Percentuale di avanzamento del processo di upload</h4>
    <progressbar
      [value]="percentage"
      [type]="progressbarType"
      [striped]="true"
      style="height: 50px"
      >{{ percentage | number: "1.0-0" }}%</progressbar
    >
    <button
      type="button"
      class="btn btn-primary"
      (click)="reloadPage()"
      *ngIf="percentage === 100"
    >
      Ricarica lista
    </button>
  </div>
</ng-template>

<!-- popup elimina -->
<app-popup-conferma
  #popupConfermaElimina
  titolo="Elimina giocatore"
  btnConferma="Elimina"
  btnAnnulla="Annulla"
  (conferma)="confermaElimina()"
  (annulla)="popupConfermaElimina.chiudiModale()"
>
</app-popup-conferma>

<!-- popup inserimento/modifica giocatore -->
<div
  *ngIf="mostraPopupModifica"
  class="modal fade"
  bsModal
  #modal="bs-modal"
  [config]="{ backdrop: 'static', keyboard: false, show: true }"
  tabindex="-1"
  role="dialog"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header titolo">
        <h4 class="modal-title">{{ titoloModale }}</h4>
      </div>

      <div class="modal-body">
        <app-player-edit
          [roster]="rosterSelected"
          (salva)="salva($event)"
          (annulla)="annulla()"
        ></app-player-edit>
      </div>
    </div>
  </div>
</div>

<!-- popup upload -->
<app-upload
  #popupUpload
  titolo="Upload giocatori"
  (upload)="confermaUpload($event)"
  (annulla)="popupUpload.chiudiModale()"
></app-upload>
